/*!
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * License
 * -------
 * Creative Commons Attribution 2.5 License:
 * http://creativecommons.org/licenses/by/2.5/
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 */
var CanvasImage=function(n){this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");document.body.appendChild(this.canvas);this.width=this.canvas.width=n.width;this.height=this.canvas.height=n.height;this.context.drawImage(n,0,0,this.width,this.height)},ColorThief,pv,MMCQ;CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)};CanvasImage.prototype.update=function(n){this.context.putImageData(n,0,0)};CanvasImage.prototype.getPixelCount=function(){return this.width*this.height};CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)};CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};ColorThief=function(){};ColorThief.prototype.getColor=function(n,t){var i=this.getPalette(n,5,t);return i[0]};ColorThief.prototype.getPalette=function(n,t,i){var r,u,o,s,h,l,a,v;typeof t=="undefined"&&(t=10);typeof i=="undefined"&&(i=10);var e=new CanvasImage(n),y=e.getImageData(),f=y.data,p=e.getPixelCount(),c=[];for(r=0;r<p;r=r+i)u=r*4,o=f[u+0],s=f[u+1],h=f[u+2],l=f[u+3],l>=125&&(o>250&&s>250&&h>250||c.push([o,s,h]));return a=MMCQ.quantize(c,t),v=a.palette(),e.removeCanvas(),v};
/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 */
pv||(pv={map:function(n,t){var i={};return t?n.map(function(n,r){return i.index=r,t.call(i,n)}):n.slice()},naturalOrder:function(n,t){return n<t?-1:n>t?1:0},sum:function(n,t){var i={};return n.reduce(t?function(n,r,u){return i.index=u,n+t.call(i,r)}:function(n,t){return n+t},0)},max:function(n,t){return Math.max.apply(null,t?pv.map(n,t):n)}});MMCQ=function(){function i(n,i,r){return(n<<2*t)+(i<<t)+r}function r(n){function r(){t.sort(n);i=!0}var t=[],i=!1;return{push:function(n){t.push(n);i=!1},peek:function(n){return i||r(),n===undefined&&(n=t.length-1),t[n]},pop:function(){return i||r(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return i||r(),t}}}function u(n,t,i,r,u,f,e){var o=this;o.r1=n;o.r2=t;o.g1=i;o.g2=r;o.b1=u;o.b2=f;o.histo=e}function e(){this.vboxes=new r(function(n,t){return pv.naturalOrder(n.vbox.count()*n.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function s(r){var h=1<<3*t,u=new Array(h),f,e,o,s;return r.forEach(function(t){e=t[0]>>n;o=t[1]>>n;s=t[2]>>n;f=i(e,o,s);u[f]=(u[f]||0)+1}),u}function h(t,i){var o=1e6,s=0,h=1e6,c=0,l=1e6,a=0,r,f,e;return t.forEach(function(t){r=t[0]>>n;f=t[1]>>n;e=t[2]>>n;r<o?o=r:r>s&&(s=r);f<h?h=f:f>c&&(c=f);e<l?l=e:e>a&&(a=e)}),new u(o,s,h,c,l,a,i)}function c(n,t){function y(n){var f=n+"1",u=n+"2",h,c,e,l,i,a=0;for(r=t[f];r<=t[u];r++)if(s[r]>o/2){for(e=t.copy(),l=t.copy(),h=r-t[f],c=t[u]-r,i=h<=c?Math.min(t[u]-1,~~(r+c/2)):Math.max(t[f],~~(r-1-h/2));!s[i];)i++;for(a=v[i];!a&&s[i-1];)a=v[--i];return e[u]=i,l[f]=e[u]+1,[e,l]}}if(t.count()){var l=t.r2-t.r1+1,a=t.g2-t.g1+1,p=t.b2-t.b1+1,c=pv.max([l,a,p]);if(t.count()==1)return[t.copy()];var o=0,s=[],v=[],r,u,f,e,h;if(c==l)for(r=t.r1;r<=t.r2;r++){for(e=0,u=t.g1;u<=t.g2;u++)for(f=t.b1;f<=t.b2;f++)h=i(r,u,f),e+=n[h]||0;o+=e;s[r]=o}else if(c==a)for(r=t.g1;r<=t.g2;r++){for(e=0,u=t.r1;u<=t.r2;u++)for(f=t.b1;f<=t.b2;f++)h=i(u,r,f),e+=n[h]||0;o+=e;s[r]=o}else for(r=t.b1;r<=t.b2;r++){for(e=0,u=t.r1;u<=t.r2;u++)for(f=t.g1;f<=t.g2;f++)h=i(u,f,r),e+=n[h]||0;o+=e;s[r]=o}return s.forEach(function(n,t){v[t]=o-n}),c==l?y("r"):c==a?y("g"):y("b")}}function l(n,i){function w(n,t){for(var u=1,r=0,i;r<f;){if(i=n.pop(),!i.count()){n.push(i);r++;continue}var e=c(a,i),o=e[0],s=e[1];if(!o)return;if(n.push(o),s&&(n.push(s),u++),u>=t)return;if(r++>f)return}}var p,l,u,v;if(!n.length||i<2||i>256)return!1;var a=s(n),b=1<<3*t,y=0;for(a.forEach(function(){y++}),y<=i,p=h(n,a),l=new r(function(n,t){return pv.naturalOrder(n.count(),t.count())}),l.push(p),w(l,o*i),u=new r(function(n,t){return pv.naturalOrder(n.count()*n.volume(),t.count()*t.volume())});l.size();)u.push(l.pop());for(w(u,i-u.size()),v=new e;u.size();)v.push(u.pop());return v}var t=5,n=8-t,f=1e3,o=.75;return u.prototype={volume:function(n){var t=this;return(!t._volume||n)&&(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(n){var t=this,o=t.histo,e,r,u,f;if(!t._count_set||n){for(e=0,r=t.r1;r<=t.r2;r++)for(u=t.g1;u<=t.g2;u++)for(f=t.b1;f<=t.b2;f++)index=i(r,u,f),e+=o[index]||0;t._count=e;t._count_set=!0}return t._count},copy:function(){var n=this;return new u(n.r1,n.r2,n.g1,n.g2,n.b1,n.b2,n.histo)},avg:function(n){var r=this,y=r.histo;if(!r._avg||n){for(var f=0,u=1<<8-t,c=0,l=0,a=0,e,s,h,v,o=r.r1;o<=r.r2;o++)for(s=r.g1;s<=r.g2;s++)for(h=r.b1;h<=r.b2;h++)v=i(o,s,h),e=y[v]||0,f+=e,c+=e*(o+.5)*u,l+=e*(s+.5)*u,a+=e*(h+.5)*u;r._avg=f?[~~(c/f),~~(l/f),~~(a/f)]:[~~(u*(r.r1+r.r2+1)/2),~~(u*(r.g1+r.g2+1)/2),~~(u*(r.b1+r.b2+1)/2)]}return r._avg},contains:function(t){var i=this,r=t[0]>>n;return gval=t[1]>>n,bval=t[2]>>n,r>=i.r1&&r<=i.r2&&gval>=i.g1&&gval<=i.g2&&bval>=i.b1&&bval<=i.b2}},e.prototype={push:function(n){this.vboxes.push({vbox:n,color:n.avg()})},palette:function(){return this.vboxes.map(function(n){return n.color})},size:function(){return this.vboxes.size()},map:function(n){for(var i=this.vboxes,t=0;t<i.size();t++)if(i.peek(t).vbox.contains(n))return i.peek(t).color;return this.nearest(n)},nearest:function(n){for(var i=this.vboxes,r,u,f,t=0;t<i.size();t++)u=Math.sqrt(Math.pow(n[0]-i.peek(t).color[0],2)+Math.pow(n[1]-i.peek(t).color[1],2)+Math.pow(n[2]-i.peek(t).color[2],2)),(u<r||r===undefined)&&(r=u,f=i.peek(t).color);return f},forcebw:function(){var n=this.vboxes,t,r,i;n.sort(function(n,t){return pv.naturalOrder(pv.sum(n.color),pv.sum(t.color))});t=n[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(n[0].color=[0,0,0]);r=n.length-1;i=n[r].color;i[0]>251&&i[1]>251&&i[2]>251&&(n[r].color=[255,255,255])}},{quantize:l}}();
//# sourceMappingURL=color-thief.min.js.map
